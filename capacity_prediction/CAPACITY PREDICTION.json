{"paragraphs":[{"title":"Capacity Prediction Using ARIMA Model","text":"%spark\nimport org.apache.spark.sql.functions.unix_timestamp\nval CBU  = z.input(\"cbu\")\n\nval PHUB = z.select(\"phub\", Seq((\"PL01\",\"PL01\"),\n                            (\"PG03\",\"PG03\")))\n\nval CMTS = z.select(\"cmts\", Seq((\"cmts77.lndn\",\"cmts77.lndn\"),\n                            (\"cmts78.brntfd\",\"cmts78.brntfd\")))\n\nval CATV =  z.select(\"macdomain\",Seq((\"CATV-MAC 1\",\"CATV-MAC 1\"),\n                                     (\"CATV-MAC 2\",\"CATV-MAC 2\"),\n                                     (\"CATV-MAC 3\",\"CATV-MAC 3\"),\n                                     (\"CATV-MAC 4\",\"CATV-MAC 4\"),\n                                     (\"CATV-MAC 5\",\"CATV-MAC 5\"),\n                                     (\"CATV-MAC 6\",\"CATV-MAC 6\"),\n                                     (\"CATV-MAC 7\",\"CATV-MAC 7\"),\n                                     (\"CATV-MAC 8\",\"CATV-MAC 8\"),\n                                     (\"CATV-MAC 9\",\"CATV-MAC 9\"),\n                                     (\"CATV-MAC 10\",\"CATV-MAC 10\"),\n                                     (\"CATV-MAC 11\",\"CATV-MAC 11\"),\n                                     (\"CATV-MAC 12\",\"CATV-MAC 12\"),\n                                     (\"CATV-MAC 13\",\"CATV-MAC 13\"),\n                                     (\"CATV-MAC 14\",\"CATV-MAC 14\"),\n                                     (\"CATV-MAC 15\",\"CATV-MAC 15\"),\n                                     (\"CATV-MAC 16\",\"CATV-MAC 16\"),\n                                     (\"CATV-MAC 17\",\"CATV-MAC 17\"),\n                                     (\"CATV-MAC 18\",\"CATV-MAC 18\"),\n                                     (\"CATV-MAC 19\",\"CATV-MAC 19\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 20\"),\n                                     (\"CATV-MAC 21\",\"CATV-MAC 21\"),\n                                     (\"CATV-MAC 22\",\"CATV-MAC 22\"),\n                                     (\"CATV-MAC 23\",\"CATV-MAC 23\"),\n                                     (\"CATV-MAC 24\",\"CATV-MAC 24\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 25\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 26\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 27\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 28\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 29\")))\n                                     \nval actual_path = \"s3://video-poc-test-case/ARIMA/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_actual\" + \"/\"\nval capacity = \"s3://video-poc-test-case/ARIMA/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_capacity\" + \"/\"\nval predicted = \"s3://video-poc-test-case/ARIMA/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_predict\" + \"/\" \n\nval actual_data_df = sc.textFile(actual_path + \"part-00000\").toDF()\nval predicted_df = sc.textFile(predicted + \"part-00000\").toDF()\nval capacity_rdd = sc.textFile(capacity + \"part-00000\").collect()\nprintln(capacity_rdd(0))\nprintln(\"prediction after this date\")\nactual_data_df.orderBy($\"value\".desc).first()\nval df = actual_data_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"capacity\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"date\",\"capacity\")\n                       .sort(unix_timestamp($\"date\", \"MM/dd/yyyy\"))\nval df_predicted = predicted_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"pred\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"pred\",\"date\")\nval df_cap = df.withColumn(\"capacity\", lit(capacity_rdd(0)))  \n\nval df_union = df.union(df_predicted)\n\nz.show(df_union)\n\n\n\n\n\n\n","dateUpdated":"2018-10-01T17:21:04+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"runOnSelectionChange":true,"title":true,"results":{"1":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{"cbu":"SW0","phub":"PG03","cmts":"cmts78.brntfd","macdomain":"CATV-MAC 6","name":""},"forms":{"cbu":{"name":"cbu","displayName":"cbu","type":"input","defaultValue":"","hidden":false,"$$hashKey":"object:8389"},"phub":{"name":"phub","displayName":"phub","type":"select","defaultValue":"","options":[{"value":"PL01","displayName":"PL01","$$hashKey":"object:8410"},{"value":"PG03","displayName":"PG03","$$hashKey":"object:8411"}],"hidden":false,"$$hashKey":"object:8390"},"cmts":{"name":"cmts","displayName":"cmts","type":"select","defaultValue":"","options":[{"value":"cmts77.lndn","displayName":"cmts77.lndn","$$hashKey":"object:8416"},{"value":"cmts78.brntfd","displayName":"cmts78.brntfd","$$hashKey":"object:8417"}],"hidden":false,"$$hashKey":"object:8391"},"macdomain":{"name":"macdomain","displayName":"macdomain","type":"select","defaultValue":"","options":[{"value":"CATV-MAC 1","displayName":"CATV-MAC 1","$$hashKey":"object:8422"},{"value":"CATV-MAC 2","displayName":"CATV-MAC 2","$$hashKey":"object:8423"},{"value":"CATV-MAC 3","displayName":"CATV-MAC 3","$$hashKey":"object:8424"},{"value":"CATV-MAC 4","displayName":"CATV-MAC 4","$$hashKey":"object:8425"},{"value":"CATV-MAC 5","displayName":"CATV-MAC 5","$$hashKey":"object:8426"},{"value":"CATV-MAC 6","displayName":"CATV-MAC 6","$$hashKey":"object:8427"},{"value":"CATV-MAC 7","displayName":"CATV-MAC 7","$$hashKey":"object:8428"},{"value":"CATV-MAC 8","displayName":"CATV-MAC 8","$$hashKey":"object:8429"},{"value":"CATV-MAC 9","displayName":"CATV-MAC 9","$$hashKey":"object:8430"},{"value":"CATV-MAC 10","displayName":"CATV-MAC 10","$$hashKey":"object:8431"},{"value":"CATV-MAC 11","displayName":"CATV-MAC 11","$$hashKey":"object:8432"},{"value":"CATV-MAC 12","displayName":"CATV-MAC 12","$$hashKey":"object:8433"},{"value":"CATV-MAC 13","displayName":"CATV-MAC 13","$$hashKey":"object:8434"},{"value":"CATV-MAC 14","displayName":"CATV-MAC 14","$$hashKey":"object:8435"},{"value":"CATV-MAC 15","displayName":"CATV-MAC 15","$$hashKey":"object:8436"},{"value":"CATV-MAC 16","displayName":"CATV-MAC 16","$$hashKey":"object:8437"},{"value":"CATV-MAC 17","displayName":"CATV-MAC 17","$$hashKey":"object:8438"},{"value":"CATV-MAC 18","displayName":"CATV-MAC 18","$$hashKey":"object:8439"},{"value":"CATV-MAC 19","displayName":"CATV-MAC 19","$$hashKey":"object:8440"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 20","$$hashKey":"object:8441"},{"value":"CATV-MAC 21","displayName":"CATV-MAC 21","$$hashKey":"object:8442"},{"value":"CATV-MAC 22","displayName":"CATV-MAC 22","$$hashKey":"object:8443"},{"value":"CATV-MAC 23","displayName":"CATV-MAC 23","$$hashKey":"object:8444"},{"value":"CATV-MAC 24","displayName":"CATV-MAC 24","$$hashKey":"object:8445"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 25","$$hashKey":"object:8446"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 26","$$hashKey":"object:8447"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 27","$$hashKey":"object:8448"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 28","$$hashKey":"object:8449"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 29","$$hashKey":"object:8450"}],"hidden":false,"$$hashKey":"object:8392"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.unix_timestamp\nCBU: Object = SW0\nPHUB: Object = PG03\nCMTS: Object = cmts78.brntfd\nCATV: Object = CATV-MAC 6\nactual_path: String = s3://video-poc-test-case/ARIMA/output/SW0/PG03/cmts78.brntfd/CATV-MAC 6/_actual/\ncapacity: String = s3://video-poc-test-case/ARIMA/output/SW0/PG03/cmts78.brntfd/CATV-MAC 6/_capacity/\npredicted: String = s3://video-poc-test-case/ARIMA/output/SW0/PG03/cmts78.brntfd/CATV-MAC 6/_predict/\nactual_data_df: org.apache.spark.sql.DataFrame = [value: string]\npredicted_df: org.apache.spark.sql.DataFrame = [value: string]\ncapacity_rdd: Array[String] = Array(4.670597654E9)\n4.670597654E9\nprediction after this date\nres176: org.apache.spark.sql.Row = [07/18/2018,9.30408764E8]\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, capacity: string]\ndf_predicted: org.apache.spark.sql.DataFrame = [pred: string, date: string]\ndf_cap: org.apache.spark.sql.DataFrame = [date: string, capacity: string]\ndf_union: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, capacity: string]\n"},{"type":"TABLE","data":"date\tcapacity\n01/01/2018\t1.2022362E7\n01/02/2018\t1.1968299E7\n01/03/2018\t1.1965969E7\n01/04/2018\t1.1961771E7\n01/05/2018\t1.1969488E7\n01/06/2018\t1.1774197E7\n01/07/2018\t1.1921561E7\n01/08/2018\t1.1950888E7\n01/09/2018\t1.1993619E7\n01/10/2018\t1.2001529E7\n01/11/2018\t1.1976715E7\n01/12/2018\t1.2052282E7\n01/13/2018\t1.1963016E7\n01/14/2018\t1.1937512E7\n01/15/2018\t1.2091663E7\n01/16/2018\t1.2090287E7\n01/17/2018\t1.3498731E7\n01/18/2018\t1.68466848E8\n01/19/2018\t1.6535706E8\n01/20/2018\t1.90472603E8\n01/21/2018\t1.96990514E8\n01/22/2018\t1.77777182E8\n01/23/2018\t1.63742334E8\n01/24/2018\t1.51360001E8\n01/25/2018\t2.20558568E8\n01/26/2018\t1.63134973E8\n01/27/2018\t1.62117972E8\n01/28/2018\t1.79224708E8\n01/29/2018\t1.60788039E8\n01/30/2018\t1.75844072E8\n01/31/2018\t1.87473025E8\n02/01/2018\t1.89033048E8\n02/02/2018\t1.87361868E8\n02/03/2018\t2.51501309E8\n02/04/2018\t2.04372406E8\n02/05/2018\t1.35832427E8\n02/06/2018\t1.59985815E8\n02/07/2018\t1.76391826E8\n02/08/2018\t2.48838885E8\n02/09/2018\t1.67017684E8\n02/10/2018\t1.89038323E8\n02/11/2018\t2.01327175E8\n02/12/2018\t1.471286E8\n02/13/2018\t1.76318507E8\n02/14/2018\t1.41455678E8\n02/15/2018\t2.12657211E8\n02/16/2018\t1.84434597E8\n02/17/2018\t1.62470442E8\n02/18/2018\t2.04532322E8\n02/19/2018\t2.29176738E8\n02/20/2018\t1.37591688E8\n02/21/2018\t1.38546535E8\n02/22/2018\t1.61791869E8\n02/23/2018\t1.59759559E8\n02/24/2018\t1.52752542E8\n02/25/2018\t1.65104325E8\n02/26/2018\t1.42393549E8\n02/27/2018\t2.32733736E8\n02/28/2018\t1.61965244E8\n03/01/2018\t2.07684345E8\n03/02/2018\t1.80749949E8\n03/03/2018\t1.48867993E8\n03/04/2018\t2.2038589E8\n03/05/2018\t1.75807584E8\n03/06/2018\t2.55248277E8\n03/07/2018\t1.65739187E8\n03/08/2018\t1.41079201E8\n03/09/2018\t2.42418917E8\n03/10/2018\t1.62530241E8\n03/11/2018\t2.19061455E8\n03/12/2018\t1.69386855E8\n03/13/2018\t2.09631688E8\n03/14/2018\t2.21062674E8\n03/15/2018\t1.67036988E8\n03/16/2018\t2.23283225E8\n03/17/2018\t1.92557511E8\n03/18/2018\t3.04861038E8\n03/19/2018\t3.03075503E8\n03/20/2018\t2.21054491E8\n03/21/2018\t2.03056751E8\n03/22/2018\t1.72640965E8\n03/23/2018\t6.66225276E8\n03/24/2018\t7.34594465E8\n03/25/2018\t7.7150661E8\n03/26/2018\t8.34083246E8\n03/27/2018\t8.27398196E8\n03/28/2018\t7.46075508E8\n03/29/2018\t7.50827029E8\n03/30/2018\t7.03260393E8\n03/31/2018\t6.28164415E8\n04/01/2018\t8.70594015E8\n04/02/2018\t8.44643473E8\n04/03/2018\t8.76114976E8\n04/04/2018\t7.45594957E8\n04/05/2018\t7.79947999E8\n04/06/2018\t7.84327725E8\n04/07/2018\t8.08463989E8\n04/08/2018\t7.50870072E8\n04/09/2018\t7.873653E8\n04/10/2018\t7.64268486E8\n04/11/2018\t8.1570735E8\n04/12/2018\t8.97573754E8\n04/13/2018\t8.6188509E8\n04/14/2018\t9.28137767E8\n04/15/2018\t8.61813057E8\n04/16/2018\t8.5377608E8\n04/17/2018\t7.50465292E8\n04/18/2018\t7.43290607E8\n04/19/2018\t7.64024811E8\n04/20/2018\t7.3415544E8\n04/21/2018\t7.30567183E8\n04/22/2018\t7.68994534E8\n04/23/2018\t6.86251763E8\n04/24/2018\t7.12633395E8\n04/25/2018\t7.39084691E8\n04/26/2018\t6.33444178E8\n04/27/2018\t6.81899504E8\n04/28/2018\t7.88326381E8\n04/29/2018\t7.70352733E8\n04/30/2018\t7.12914453E8\n05/01/2018\t6.92772888E8\n05/02/2018\t7.46147867E8\n05/03/2018\t7.72396096E8\n05/04/2018\t6.71317175E8\n05/05/2018\t7.840074E8\n05/06/2018\t7.8271611E8\n05/07/2018\t7.09071952E8\n05/08/2018\t7.35529351E8\n05/09/2018\t6.67932446E8\n05/10/2018\t8.39815435E8\n05/11/2018\t6.44532944E8\n05/12/2018\t7.59128518E8\n05/13/2018\t7.6992247E8\n05/14/2018\t7.10241309E8\n05/15/2018\t7.31136459E8\n05/16/2018\t9.39892605E8\n05/17/2018\t9.27029241E8\n05/18/2018\t6.91166969E8\n05/19/2018\t6.96828148E8\n05/20/2018\t6.94652268E8\n05/21/2018\t8.28769166E8\n05/22/2018\t7.8248448E8\n05/23/2018\t7.03021814E8\n05/24/2018\t7.27842905E8\n05/25/2018\t7.52918544E8\n05/26/2018\t7.07808367E8\n05/27/2018\t8.47710709E8\n05/28/2018\t8.3546164E8\n05/29/2018\t7.50719567E8\n05/30/2018\t8.07668618E8\n05/31/2018\t6.52926699E8\n06/01/2018\t6.90490971E8\n06/02/2018\t6.6670006E8\n06/03/2018\t7.63265496E8\n06/04/2018\t7.61891254E8\n06/05/2018\t7.55407098E8\n06/06/2018\t7.13293074E8\n06/07/2018\t7.72064362E8\n06/08/2018\t7.16112456E8\n06/09/2018\t5.56821133E8\n06/10/2018\t8.6431202E8\n06/11/2018\t7.76585199E8\n06/12/2018\t8.8168677E8\n06/13/2018\t8.33278564E8\n06/14/2018\t7.98740401E8\n06/15/2018\t7.5584699E8\n06/16/2018\t6.7904674E8\n06/17/2018\t9.06093476E8\n06/18/2018\t8.24766361E8\n06/19/2018\t7.33577219E8\n06/20/2018\t7.47506992E8\n06/21/2018\t8.05648842E8\n06/22/2018\t1.057408751E9\n06/23/2018\t7.10035341E8\n06/24/2018\t7.74136201E8\n06/25/2018\t8.21662045E8\n06/26/2018\t8.00626258E8\n06/27/2018\t8.03566328E8\n06/28/2018\t7.55195654E8\n06/29/2018\t7.1631254E8\n06/30/2018\t5.91717379E8\n07/01/2018\t5.54529558E8\n07/02/2018\t8.61687014E8\n07/03/2018\t8.37059832E8\n07/04/2018\t7.92486167E8\n07/05/2018\t7.90870178E8\n07/06/2018\t6.58933463E8\n07/07/2018\t6.75534057E8\n07/08/2018\t7.20147482E8\n07/09/2018\t7.94643586E8\n07/10/2018\t8.05361666E8\n07/11/2018\t6.92194402E8\n07/12/2018\t9.22381916E8\n07/13/2018\t7.87663163E8\n07/14/2018\t7.26464084E8\n07/15/2018\t7.95319164E8\n07/16/2018\t8.29534732E8\n07/17/2018\t8.60891445E8\n07/18/2018\t9.30408764E8\n7/25/2018\t5.1501359191554344E8\n8/19/2018\t5.149712775436345E8\n7/26/2018\t5.149811884173008E8\n8/20/2018\t5.149712775436345E8\n7/24/2018\t5.151519383138485E8\n8/18/2018\t5.149712775436345E8\n8/5/2018\t5.1497127754855883E8\n8/30/2018\t5.149712775436345E8\n7/29/2018\t5.1497140488926977E8\n8/23/2018\t5.149712775436345E8\n8/12/2018\t5.1497127754363465E8\n9/6/2018\t5.149712775436345E8\n7/30/2018\t5.149713073705336E8\n8/24/2018\t5.149712775436345E8\n7/19/2018\t7.712683529192684E8\n8/13/2018\t5.1497127754363453E8\n7/27/2018\t5.149735988688107E8\n8/21/2018\t5.149712775436345E8\n7/28/2018\t5.149718212444983E8\n8/22/2018\t5.149712775436345E8\n8/4/2018\t5.149712775646591E8\n8/29/2018\t5.149712775436345E8\n7/21/2018\t5.290314851475545E8\n8/15/2018\t5.149712775436345E8\n7/20/2018\t5.750011874890856E8\n8/14/2018\t5.149712775436345E8\n8/2/2018\t5.1497127792688274E8\n8/27/2018\t5.149712775436345E8\n8/9/2018\t5.149712775436493E8\n8/7/2018\t5.149712775439046E8\n9/3/2018\t5.149712775436345E8\n9/1/2018\t5.149712775436345E8\n8/8/2018\t5.149712775436977E8\n9/2/2018\t5.149712775436345E8\n7/23/2018\t5.1574260682070714E8\n8/17/2018\t5.149712775436345E8\n7/31/2018\t5.149712845296918E8\n8/25/2018\t5.149712775436345E8\n7/22/2018\t5.182644598596661E8\n8/16/2018\t5.149712775436345E8\n8/11/2018\t5.1497127754363525E8\n9/5/2018\t5.149712775436345E8\n8/3/2018\t5.149712776333989E8\n8/28/2018\t5.149712775436345E8\n8/6/2018\t5.149712775447879E8\n8/31/2018\t5.149712775436345E8\n8/10/2018\t5.1497127754363793E8\n9/4/2018\t5.149712775436345E8\n8/1/2018\t5.1497127917990905E8\n8/26/2018\t5.149712775436345E8\n"}]},"apps":[],"jobName":"paragraph_1538412452803_-978171315","id":"20180831-151020_583496686","dateCreated":"2018-10-01T16:47:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:268","user":"anonymous","dateFinished":"2018-10-01T17:20:57+0000","dateStarted":"2018-10-01T17:20:42+0000"},{"title":"Capacity Prediction Using LSTM Model","text":"%spark\nimport org.apache.spark.sql.functions.unix_timestamp\n\nval CBU  = z.input(\"cbu\")\n\nval PHUB = z.select(\"phub\", Seq((\"PL01\",\"PL01\"),\n                            (\"PG03\",\"PG03\")))\n\nval CMTS = z.select(\"cmts\", Seq((\"cmts77.lndn\",\"cmts77.lndn\"),\n                            (\"cmts78.brntfd\",\"cmts78.brntfd\")))\n\nval CATV =  z.select(\"macdomain\",Seq((\"CATV-MAC 1\",\"CATV-MAC 1\"),\n                                     (\"CATV-MAC 2\",\"CATV-MAC 2\"),\n                                     (\"CATV-MAC 3\",\"CATV-MAC 3\"),\n                                     (\"CATV-MAC 4\",\"CATV-MAC 4\"),\n                                     (\"CATV-MAC 5\",\"CATV-MAC 5\"),\n                                     (\"CATV-MAC 6\",\"CATV-MAC 6\"),\n                                     (\"CATV-MAC 7\",\"CATV-MAC 7\"),\n                                     (\"CATV-MAC 8\",\"CATV-MAC 8\"),\n                                     (\"CATV-MAC 9\",\"CATV-MAC 9\"),\n                                     (\"CATV-MAC 10\",\"CATV-MAC 10\"),\n                                     (\"CATV-MAC 11\",\"CATV-MAC 11\"),\n                                     (\"CATV-MAC 12\",\"CATV-MAC 12\"),\n                                     (\"CATV-MAC 13\",\"CATV-MAC 13\"),\n                                     (\"CATV-MAC 14\",\"CATV-MAC 14\"),\n                                     (\"CATV-MAC 15\",\"CATV-MAC 15\"),\n                                     (\"CATV-MAC 16\",\"CATV-MAC 16\"),\n                                     (\"CATV-MAC 17\",\"CATV-MAC 17\"),\n                                     (\"CATV-MAC 18\",\"CATV-MAC 18\"),\n                                     (\"CATV-MAC 19\",\"CATV-MAC 19\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 20\"),\n                                     (\"CATV-MAC 21\",\"CATV-MAC 21\"),\n                                     (\"CATV-MAC 22\",\"CATV-MAC 22\"),\n                                     (\"CATV-MAC 23\",\"CATV-MAC 23\"),\n                                     (\"CATV-MAC 24\",\"CATV-MAC 24\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 25\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 26\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 27\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 28\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 29\")))\n                                     \nval actual_path = \"s3://video-poc-test-case/RNN/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_actual\" + \"/\"\nval capacity = \"s3://video-poc-test-case/RNN/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_capacity\" + \"/\"\nval predicted = \"s3://video-poc-test-case/RNN/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_predict\" + \"/\" \n\nval actual_data_df = sc.textFile(actual_path + \"part-00000\").toDF()\nval predicted_df = sc.textFile(predicted + \"part-00000\").toDF()\nval capacity_rdd = sc.textFile(capacity + \"part-00000\").collect()\nprintln(capacity_rdd(0))\nprintln(\"prediction after this date\")\nactual_data_df.orderBy($\"value\".desc).first()\nval df = actual_data_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"capacity\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"date\",\"capacity\")\n                       .sort(unix_timestamp($\"date\", \"MM/dd/yyyy\"))\nval df_predicted = predicted_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"pred\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"date\",\"pred\")\nval df_cap = df.withColumn(\"capacity\", lit(capacity_rdd(0)))  \n\nval df_union = df.union(df_predicted)\n\nz.show(df_union)\n\n\n\n\n\n","dateUpdated":"2018-10-01T17:21:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"runOnSelectionChange":true,"title":true,"results":{"1":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{"cbu":"SW0","phub":"PG03","cmts":"cmts77.lndn","macdomain":"CATV-MAC 1"},"forms":{"cbu":{"name":"cbu","displayName":"cbu","type":"input","defaultValue":"","hidden":false,"$$hashKey":"object:8575"},"phub":{"name":"phub","displayName":"phub","type":"select","defaultValue":"","options":[{"value":"PL01","displayName":"PL01","$$hashKey":"object:8596"},{"value":"PG03","displayName":"PG03","$$hashKey":"object:8597"}],"hidden":false,"$$hashKey":"object:8576"},"cmts":{"name":"cmts","displayName":"cmts","type":"select","defaultValue":"","options":[{"value":"cmts77.lndn","displayName":"cmts77.lndn","$$hashKey":"object:8602"},{"value":"cmts78.brntfd","displayName":"cmts78.brntfd","$$hashKey":"object:8603"}],"hidden":false,"$$hashKey":"object:8577"},"macdomain":{"name":"macdomain","displayName":"macdomain","type":"select","defaultValue":"","options":[{"value":"CATV-MAC 1","displayName":"CATV-MAC 1","$$hashKey":"object:8608"},{"value":"CATV-MAC 2","displayName":"CATV-MAC 2","$$hashKey":"object:8609"},{"value":"CATV-MAC 3","displayName":"CATV-MAC 3","$$hashKey":"object:8610"},{"value":"CATV-MAC 4","displayName":"CATV-MAC 4","$$hashKey":"object:8611"},{"value":"CATV-MAC 5","displayName":"CATV-MAC 5","$$hashKey":"object:8612"},{"value":"CATV-MAC 6","displayName":"CATV-MAC 6","$$hashKey":"object:8613"},{"value":"CATV-MAC 7","displayName":"CATV-MAC 7","$$hashKey":"object:8614"},{"value":"CATV-MAC 8","displayName":"CATV-MAC 8","$$hashKey":"object:8615"},{"value":"CATV-MAC 9","displayName":"CATV-MAC 9","$$hashKey":"object:8616"},{"value":"CATV-MAC 10","displayName":"CATV-MAC 10","$$hashKey":"object:8617"},{"value":"CATV-MAC 11","displayName":"CATV-MAC 11","$$hashKey":"object:8618"},{"value":"CATV-MAC 12","displayName":"CATV-MAC 12","$$hashKey":"object:8619"},{"value":"CATV-MAC 13","displayName":"CATV-MAC 13","$$hashKey":"object:8620"},{"value":"CATV-MAC 14","displayName":"CATV-MAC 14","$$hashKey":"object:8621"},{"value":"CATV-MAC 15","displayName":"CATV-MAC 15","$$hashKey":"object:8622"},{"value":"CATV-MAC 16","displayName":"CATV-MAC 16","$$hashKey":"object:8623"},{"value":"CATV-MAC 17","displayName":"CATV-MAC 17","$$hashKey":"object:8624"},{"value":"CATV-MAC 18","displayName":"CATV-MAC 18","$$hashKey":"object:8625"},{"value":"CATV-MAC 19","displayName":"CATV-MAC 19","$$hashKey":"object:8626"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 20","$$hashKey":"object:8627"},{"value":"CATV-MAC 21","displayName":"CATV-MAC 21","$$hashKey":"object:8628"},{"value":"CATV-MAC 22","displayName":"CATV-MAC 22","$$hashKey":"object:8629"},{"value":"CATV-MAC 23","displayName":"CATV-MAC 23","$$hashKey":"object:8630"},{"value":"CATV-MAC 24","displayName":"CATV-MAC 24","$$hashKey":"object:8631"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 25","$$hashKey":"object:8632"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 26","$$hashKey":"object:8633"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 27","$$hashKey":"object:8634"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 28","$$hashKey":"object:8635"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 29","$$hashKey":"object:8636"}],"hidden":false,"$$hashKey":"object:8578"}}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.unix_timestamp\nCBU: Object = SW0\nPHUB: Object = PG03\nCMTS: Object = cmts77.lndn\nCATV: Object = CATV-MAC 1\nactual_path: String = s3://video-poc-test-case/RNN/output/SW0/PG03/cmts77.lndn/CATV-MAC 1/_actual/\ncapacity: String = s3://video-poc-test-case/RNN/output/SW0/PG03/cmts77.lndn/CATV-MAC 1/_capacity/\npredicted: String = s3://video-poc-test-case/RNN/output/SW0/PG03/cmts77.lndn/CATV-MAC 1/_predict/\nactual_data_df: org.apache.spark.sql.DataFrame = [value: string]\npredicted_df: org.apache.spark.sql.DataFrame = [value: string]\norg.apache.hadoop.mapred.InvalidInputException: Input path does not exist: s3://video-poc-test-case/RNN/output/SW0/PG03/cmts77.lndn/CATV-MAC 1/_capacity/part-00000\n  at org.apache.hadoop.mapred.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:260)\n  at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:208)\n  at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:288)\n  at org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:200)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:253)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:251)\n  at scala.Option.getOrElse(Option.scala:121)\n  at org.apache.spark.rdd.RDD.partitions(RDD.scala:251)\n  at org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:253)\n  at org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:251)\n  at scala.Option.getOrElse(Option.scala:121)\n  at org.apache.spark.rdd.RDD.partitions(RDD.scala:251)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)\n  at org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:939)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:363)\n  at org.apache.spark.rdd.RDD.collect(RDD.scala:938)\n  ... 51 elided\n"}]},"apps":[],"jobName":"paragraph_1538412452807_-979710311","id":"20180831-152216_1205059470","dateCreated":"2018-10-01T16:47:32+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:269","user":"anonymous","dateFinished":"2018-10-01T17:21:35+0000","dateStarted":"2018-10-01T17:21:33+0000"},{"text":"%spark\nimport org.apache.spark.sql.functions.unix_timestamp\n\nval CBU  = z.input(\"cbu\")\n\nval PHUB = z.select(\"phub\", Seq((\"PG07\",\"PG07\"),\n                            (\"PG03\",\"PG03\")))\n\nval CMTS = z.select(\"cmts\", Seq((\"cmts77.ktgc\",\"cmts77.ktgc\"),\n                            (\"cmts78.brntfd\",\"cmts78.brntfd\")))\n\nval CATV =  z.select(\"macdomain\",Seq((\"CATV-MAC 1\",\"CATV-MAC 1\"),\n                                     (\"CATV-MAC 2\",\"CATV-MAC 2\"),\n                                     (\"CATV-MAC 3\",\"CATV-MAC 3\"),\n                                     (\"CATV-MAC 4\",\"CATV-MAC 4\"),\n                                     (\"CATV-MAC 5\",\"CATV-MAC 5\"),\n                                     (\"CATV-MAC 6\",\"CATV-MAC 6\"),\n                                     (\"CATV-MAC 7\",\"CATV-MAC 7\"),\n                                     (\"CATV-MAC 8\",\"CATV-MAC 8\"),\n                                     (\"CATV-MAC 9\",\"CATV-MAC 9\"),\n                                     (\"CATV-MAC 10\",\"CATV-MAC 10\"),\n                                     (\"CATV-MAC 11\",\"CATV-MAC 11\"),\n                                     (\"CATV-MAC 12\",\"CATV-MAC 12\"),\n                                     (\"CATV-MAC 13\",\"CATV-MAC 13\"),\n                                     (\"CATV-MAC 14\",\"CATV-MAC 14\"),\n                                     (\"CATV-MAC 15\",\"CATV-MAC 15\"),\n                                     (\"CATV-MAC 16\",\"CATV-MAC 16\"),\n                                     (\"CATV-MAC 17\",\"CATV-MAC 17\"),\n                                     (\"CATV-MAC 18\",\"CATV-MAC 18\"),\n                                     (\"CATV-MAC 19\",\"CATV-MAC 19\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 20\"),\n                                     (\"CATV-MAC 21\",\"CATV-MAC 21\"),\n                                     (\"CATV-MAC 22\",\"CATV-MAC 22\"),\n                                     (\"CATV-MAC 23\",\"CATV-MAC 23\"),\n                                     (\"CATV-MAC 24\",\"CATV-MAC 24\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 25\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 26\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 27\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 28\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 29\")))\n                                     \nval actual_path = \"s3://video-poc-test-case/RNN/up_trending/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_actual\" + \"/\"\nval capacity = \"s3://video-poc-test-case/RNN/up_trending/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_capacity\" + \"/\"\nval predicted = \"s3://video-poc-test-case/RNN/up_trending/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_predict\" + \"/\" \n\nval actual_data_df = sc.textFile(actual_path + \"part-00000\").toDF()\nval predicted_df = sc.textFile(predicted + \"part-00000\").toDF()\nval capacity_rdd = sc.textFile(capacity + \"part-00000\").collect()\nprintln(capacity_rdd(0))\nprintln(\"prediction after this date\")\nactual_data_df.orderBy($\"value\".desc).first()\nval df = actual_data_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"capacity\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"date\",\"capacity\")\n                       .sort(unix_timestamp($\"date\", \"MM/dd/yyyy\"))\nval df_predicted = predicted_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"pred\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"date\",\"pred\")\nval df_cap = df.withColumn(\"capacity\", lit(capacity_rdd(0)))  \n\nval df_union = df.union(df_predicted)\n\nz.show(df_union)\n","dateUpdated":"2018-10-01T17:21:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"runOnSelectionChange":true,"tableHide":false,"title":true},"settings":{"params":{"cbu":"SWO","phub":"PG07","cmts":"cmts77.ktgc","macdomain":"CATV-MAC 1"},"forms":{"cbu":{"name":"cbu","displayName":"cbu","type":"input","defaultValue":"","hidden":false,"$$hashKey":"object:8639"},"phub":{"name":"phub","displayName":"phub","type":"select","defaultValue":"","options":[{"value":"PG07","displayName":"PG07","$$hashKey":"object:8660"},{"value":"PG03","displayName":"PG03","$$hashKey":"object:8661"}],"hidden":false,"$$hashKey":"object:8640"},"cmts":{"name":"cmts","displayName":"cmts","type":"select","defaultValue":"","options":[{"value":"cmts77.ktgc","displayName":"cmts77.ktgc","$$hashKey":"object:8666"},{"value":"cmts78.brntfd","displayName":"cmts78.brntfd","$$hashKey":"object:8667"}],"hidden":false,"$$hashKey":"object:8641"},"macdomain":{"name":"macdomain","displayName":"macdomain","type":"select","defaultValue":"","options":[{"value":"CATV-MAC 1","displayName":"CATV-MAC 1","$$hashKey":"object:8672"},{"value":"CATV-MAC 2","displayName":"CATV-MAC 2","$$hashKey":"object:8673"},{"value":"CATV-MAC 3","displayName":"CATV-MAC 3","$$hashKey":"object:8674"},{"value":"CATV-MAC 4","displayName":"CATV-MAC 4","$$hashKey":"object:8675"},{"value":"CATV-MAC 5","displayName":"CATV-MAC 5","$$hashKey":"object:8676"},{"value":"CATV-MAC 6","displayName":"CATV-MAC 6","$$hashKey":"object:8677"},{"value":"CATV-MAC 7","displayName":"CATV-MAC 7","$$hashKey":"object:8678"},{"value":"CATV-MAC 8","displayName":"CATV-MAC 8","$$hashKey":"object:8679"},{"value":"CATV-MAC 9","displayName":"CATV-MAC 9","$$hashKey":"object:8680"},{"value":"CATV-MAC 10","displayName":"CATV-MAC 10","$$hashKey":"object:8681"},{"value":"CATV-MAC 11","displayName":"CATV-MAC 11","$$hashKey":"object:8682"},{"value":"CATV-MAC 12","displayName":"CATV-MAC 12","$$hashKey":"object:8683"},{"value":"CATV-MAC 13","displayName":"CATV-MAC 13","$$hashKey":"object:8684"},{"value":"CATV-MAC 14","displayName":"CATV-MAC 14","$$hashKey":"object:8685"},{"value":"CATV-MAC 15","displayName":"CATV-MAC 15","$$hashKey":"object:8686"},{"value":"CATV-MAC 16","displayName":"CATV-MAC 16","$$hashKey":"object:8687"},{"value":"CATV-MAC 17","displayName":"CATV-MAC 17","$$hashKey":"object:8688"},{"value":"CATV-MAC 18","displayName":"CATV-MAC 18","$$hashKey":"object:8689"},{"value":"CATV-MAC 19","displayName":"CATV-MAC 19","$$hashKey":"object:8690"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 20","$$hashKey":"object:8691"},{"value":"CATV-MAC 21","displayName":"CATV-MAC 21","$$hashKey":"object:8692"},{"value":"CATV-MAC 22","displayName":"CATV-MAC 22","$$hashKey":"object:8693"},{"value":"CATV-MAC 23","displayName":"CATV-MAC 23","$$hashKey":"object:8694"},{"value":"CATV-MAC 24","displayName":"CATV-MAC 24","$$hashKey":"object:8695"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 25","$$hashKey":"object:8696"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 26","$$hashKey":"object:8697"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 27","$$hashKey":"object:8698"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 28","$$hashKey":"object:8699"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 29","$$hashKey":"object:8700"}],"hidden":false,"$$hashKey":"object:8642"}}},"apps":[],"jobName":"paragraph_1538412452808_-981634055","id":"20180906-183933_182461646","dateCreated":"2018-10-01T16:47:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:270","user":"anonymous","dateFinished":"2018-10-01T17:18:50+0000","dateStarted":"2018-10-01T17:18:34+0000","title":"Capacity Trend Prediction Using LSTM","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.unix_timestamp\nCBU: Object = SWO\nPHUB: Object = PG07\nCMTS: Object = cmts77.ktgc\nCATV: Object = CATV-MAC 1\nactual_path: String = s3://video-poc-test-case/RNN/up_trending/output/SWO/PG07/cmts77.ktgc/CATV-MAC 1/_actual/\ncapacity: String = s3://video-poc-test-case/RNN/up_trending/output/SWO/PG07/cmts77.ktgc/CATV-MAC 1/_capacity/\npredicted: String = s3://video-poc-test-case/RNN/up_trending/output/SWO/PG07/cmts77.ktgc/CATV-MAC 1/_predict/\nactual_data_df: org.apache.spark.sql.DataFrame = [value: string]\npredicted_df: org.apache.spark.sql.DataFrame = [value: string]\ncapacity_rdd: Array[String] = Array(2.335298827E9)\n2.335298827E9\nprediction after this date\nres165: org.apache.spark.sql.Row = [4/9/2018,3.160210759090911E8]\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, capacity: string]\ndf_predicted: org.apache.spark.sql.DataFrame = [date: string, pred: string]\ndf_cap: org.apache.spark.sql.DataFrame = [date: string, capacity: string]\ndf_union: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, capacity: string]\n"},{"type":"TABLE","data":"date\tcapacity\n3/2/2018\t8.5632902E7\n3/3/2018\t9.169574868181819E7\n3/4/2018\t9.775859536363637E7\n3/5/2018\t1.0382144204545456E8\n3/6/2018\t1.0988428872727275E8\n3/7/2018\t1.1594713540909094E8\n3/8/2018\t1.2200998209090912E8\n3/9/2018\t1.2807282877272731E8\n3/10/2018\t1.341356754545455E8\n3/11/2018\t1.401985221363637E8\n3/12/2018\t1.4626136881818187E8\n3/13/2018\t1.5232421550000006E8\n3/14/2018\t1.5838706218181825E8\n3/15/2018\t1.6444990886363643E8\n3/16/2018\t1.7051275554545462E8\n3/17/2018\t1.765756022272728E8\n3/18/2018\t1.82638448909091E8\n3/19/2018\t1.8870129559090918E8\n3/20/2018\t1.9476414227272737E8\n3/21/2018\t2.0082698895454556E8\n3/22/2018\t2.0688983563636374E8\n3/23/2018\t2.1295268231818193E8\n3/24/2018\t2.1901552900000012E8\n3/25/2018\t2.250783756818183E8\n3/26/2018\t2.311412223636365E8\n3/27/2018\t2.3720406904545468E8\n3/28/2018\t2.4326691572727287E8\n3/29/2018\t2.4932976240909106E8\n3/30/2018\t2.5539260909090924E8\n3/31/2018\t2.6145545577272743E8\n4/1/2018\t2.6751830245454562E8\n4/2/2018\t2.735811491363638E8\n4/3/2018\t2.79643995818182E8\n4/4/2018\t2.857068425000002E8\n4/5/2018\t2.9176968918181837E8\n4/6/2018\t2.9783253586363655E8\n4/7/2018\t3.0389538254545474E8\n4/8/2018\t3.099582292272729E8\n4/9/2018\t3.160210759090911E8\n4/10/2018\t2.66765254E8\n4/10/2018\t187044670.0\n4/11/2018\t170382670.0\n4/12/2018\t186393070.0\n4/13/2018\t192077870.0\n4/14/2018\t190334500.0\n4/15/2018\t195619330.0\n4/16/2018\t191195860.0\n4/17/2018\t167977940.0\n4/18/2018\t189131730.0\n4/19/2018\t186776580.0\n4/20/2018\t176008880.0\n4/21/2018\t196576220.0\n4/22/2018\t182193170.0\n4/23/2018\t179934910.0\n4/24/2018\t176085150.0\n4/25/2018\t192203600.0\n4/26/2018\t179427200.0\n4/27/2018\t172718260.0\n4/28/2018\t188878960.0\n4/29/2018\t196756380.0\n4/30/2018\t176305100.0\n4/31/2018\t184962020.0\n5/1/2018\t192067890.0\n5/2/2018\t196883980.0\n5/3/2018\t182101540.0\n5/4/2018\t199448530.0\n5/5/2018\t198100980.0\n5/6/2018\t197672350.0\n5/7/2018\t194085420.0\n5/8/2018\t170199360.0\n5/9/2018\t188612880.0\n5/10/2018\t189187600.0\n5/11/2018\t192263180.0\n5/12/2018\t187965170.0\n5/13/2018\t195122480.0\n5/14/2018\t190577970.0\n5/15/2018\t198100600.0\n5/16/2018\t176126670.0\n5/17/2018\t198489630.0\n5/18/2018\t176301230.0\n5/19/2018\t178016060.0\n5/20/2018\t175090800.0\n5/21/2018\t184058900.0\n5/22/2018\t170737260.0\n5/23/2018\t198818900.0\n5/24/2018\t178705420.0\n5/25/2018\t185093500.0\n5/26/2018\t187862600.0\n5/27/2018\t195061220.0\n5/28/2018\t188146350.0\n5/29/2018\t187645820.0\n5/30/2018\t170996480.0\n5/31/2018\t188165570.0\n6/1/2018\t178691020.0\n6/2/2018\t177470020.0\n6/3/2018\t190885500.0\n6/4/2018\t196337020.0\n6/5/2018\t176414060.0\n6/6/2018\t195244850.0\n6/7/2018\t188305140.0\n6/8/2018\t172454750.0\n6/9/2018\t176081550.0\n6/10/2018\t180790740.0\n6/11/2018\t189284100.0\n6/12/2018\t181332100.0\n6/13/2018\t200095410.0\n6/14/2018\t195117870.0\n6/15/2018\t190560210.0\n6/16/2018\t179880670.0\n6/17/2018\t183417250.0\n6/18/2018\t196741650.0\n6/19/2018\t179128720.0\n6/20/2018\t177522080.0\n6/21/2018\t183107540.0\n6/22/2018\t196177070.0\n6/23/2018\t193656240.0\n6/24/2018\t189945250.0\n6/25/2018\t198805070.0\n6/26/2018\t190792720.0\n6/27/2018\t196798020.0\n6/28/2018\t180867760.0\n6/29/2018\t189348300.0\n6/30/2018\t175141470.0\n6/31/2018\t177228160.0\n7/1/2018\t187879820.0\n7/2/2018\t191662880.0\n7/3/2018\t192787890.0\n7/4/2018\t197460400.0\n7/5/2018\t175074770.0\n7/6/2018\t196727650.0\n7/7/2018\t186006240.0\n7/8/2018\t191065310.0\n7/9/2018\t169958540.0\n7/10/2018\t195003870.0\n7/11/2018\t183282910.0\n7/12/2018\t174057280.0\n7/13/2018\t184815970.0\n7/14/2018\t182499700.0\n"}]}},{"text":"%spark\n\nimport org.apache.spark.sql.functions.unix_timestamp\n\nval CBU  = z.input(\"cbu\")\n\nval PHUB = z.select(\"phub\", Seq((\"PL01\",\"PL01\"),\n                            (\"PG03\",\"PG03\")))\n\nval CMTS = z.select(\"cmts\", Seq((\"cmts77.lndn\",\"cmts77.lndn\"),\n                            (\"cmts78.brntfd\",\"cmts78.brntfd\")))\n\nval CATV =  z.select(\"macdomain\",Seq((\"CATV-MAC 1\",\"CATV-MAC 1\"),\n                                     (\"CATV-MAC 2\",\"CATV-MAC 2\"),\n                                     (\"CATV-MAC 3\",\"CATV-MAC 3\"),\n                                     (\"CATV-MAC 4\",\"CATV-MAC 4\"),\n                                     (\"CATV-MAC 5\",\"CATV-MAC 5\"),\n                                     (\"CATV-MAC 6\",\"CATV-MAC 6\"),\n                                     (\"CATV-MAC 7\",\"CATV-MAC 7\"),\n                                     (\"CATV-MAC 8\",\"CATV-MAC 8\"),\n                                     (\"CATV-MAC 9\",\"CATV-MAC 9\"),\n                                     (\"CATV-MAC 10\",\"CATV-MAC 10\"),\n                                     (\"CATV-MAC 11\",\"CATV-MAC 11\"),\n                                     (\"CATV-MAC 12\",\"CATV-MAC 12\"),\n                                     (\"CATV-MAC 13\",\"CATV-MAC 13\"),\n                                     (\"CATV-MAC 14\",\"CATV-MAC 14\"),\n                                     (\"CATV-MAC 15\",\"CATV-MAC 15\"),\n                                     (\"CATV-MAC 16\",\"CATV-MAC 16\"),\n                                     (\"CATV-MAC 17\",\"CATV-MAC 17\"),\n                                     (\"CATV-MAC 18\",\"CATV-MAC 18\"),\n                                     (\"CATV-MAC 19\",\"CATV-MAC 19\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 20\"),\n                                     (\"CATV-MAC 21\",\"CATV-MAC 21\"),\n                                     (\"CATV-MAC 22\",\"CATV-MAC 22\"),\n                                     (\"CATV-MAC 23\",\"CATV-MAC 23\"),\n                                     (\"CATV-MAC 24\",\"CATV-MAC 24\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 25\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 26\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 27\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 28\"),\n                                     (\"CATV-MAC 20\",\"CATV-MAC 29\")))\n                                     \nval actual_path = \"s3://video-poc-test-case/ARIMA/up_trending/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_actual\" + \"/\"\nval capacity = \"s3://video-poc-test-case/ARIMA/up_trending/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_capacity\" + \"/\"\nval predicted = \"s3://video-poc-test-case/ARIMA/up_trending/output\" + \"/\" + CBU + \"/\" + PHUB + \"/\" + CMTS + \"/\" + CATV + \"/\" + \"_predict\" + \"/\" \n\nval actual_data_df = sc.textFile(actual_path + \"part-00000\").toDF()\nval predicted_df = sc.textFile(predicted + \"part-00000\").toDF()\nval capacity_rdd = sc.textFile(capacity + \"part-00000\").collect()\nprintln(capacity_rdd(0))\nprintln(\"prediction after this date\")\nactual_data_df.orderBy($\"value\".desc).first()\nval df = actual_data_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"capacity\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"date\",\"capacity\")\n                       .sort(unix_timestamp($\"date\", \"MM/dd/yyyy\"))\nval df_predicted = predicted_df.withColumn(\"date\", split(col(\"value\"), \"\\\\,\").getItem(0))\n                       .withColumn(\"pred\", split(col(\"value\"), \"\\\\,\").getItem(1))\n                       .select(\"pred\",\"date\")\nval df_cap = df.withColumn(\"capacity\", lit(capacity_rdd(0)))  \n\nval df_union = df.union(df_predicted)\n\nz.show(df_union)\n\n\n","user":"anonymous","dateUpdated":"2018-10-01T17:17:25+0000","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"editorHide":false},"settings":{"params":{"cbu":"SWO","phub":"PG07","cmts":"cmts77.ktgc","macdomain":"CATV-MAC 1"},"forms":{"cbu":{"name":"cbu","displayName":"cbu","type":"input","defaultValue":"","hidden":false,"$$hashKey":"object:6968"},"phub":{"name":"phub","displayName":"phub","type":"select","defaultValue":"","options":[{"value":"PL01","displayName":"PL01","$$hashKey":"object:6989"},{"value":"PG03","displayName":"PG03","$$hashKey":"object:6990"}],"hidden":false,"$$hashKey":"object:6969"},"cmts":{"name":"cmts","displayName":"cmts","type":"select","defaultValue":"","options":[{"value":"cmts77.lndn","displayName":"cmts77.lndn","$$hashKey":"object:6995"},{"value":"cmts78.brntfd","displayName":"cmts78.brntfd","$$hashKey":"object:6996"}],"hidden":false,"$$hashKey":"object:6970"},"macdomain":{"name":"macdomain","displayName":"macdomain","type":"select","defaultValue":"","options":[{"value":"CATV-MAC 1","displayName":"CATV-MAC 1","$$hashKey":"object:7001"},{"value":"CATV-MAC 2","displayName":"CATV-MAC 2","$$hashKey":"object:7002"},{"value":"CATV-MAC 3","displayName":"CATV-MAC 3","$$hashKey":"object:7003"},{"value":"CATV-MAC 4","displayName":"CATV-MAC 4","$$hashKey":"object:7004"},{"value":"CATV-MAC 5","displayName":"CATV-MAC 5","$$hashKey":"object:7005"},{"value":"CATV-MAC 6","displayName":"CATV-MAC 6","$$hashKey":"object:7006"},{"value":"CATV-MAC 7","displayName":"CATV-MAC 7","$$hashKey":"object:7007"},{"value":"CATV-MAC 8","displayName":"CATV-MAC 8","$$hashKey":"object:7008"},{"value":"CATV-MAC 9","displayName":"CATV-MAC 9","$$hashKey":"object:7009"},{"value":"CATV-MAC 10","displayName":"CATV-MAC 10","$$hashKey":"object:7010"},{"value":"CATV-MAC 11","displayName":"CATV-MAC 11","$$hashKey":"object:7011"},{"value":"CATV-MAC 12","displayName":"CATV-MAC 12","$$hashKey":"object:7012"},{"value":"CATV-MAC 13","displayName":"CATV-MAC 13","$$hashKey":"object:7013"},{"value":"CATV-MAC 14","displayName":"CATV-MAC 14","$$hashKey":"object:7014"},{"value":"CATV-MAC 15","displayName":"CATV-MAC 15","$$hashKey":"object:7015"},{"value":"CATV-MAC 16","displayName":"CATV-MAC 16","$$hashKey":"object:7016"},{"value":"CATV-MAC 17","displayName":"CATV-MAC 17","$$hashKey":"object:7017"},{"value":"CATV-MAC 18","displayName":"CATV-MAC 18","$$hashKey":"object:7018"},{"value":"CATV-MAC 19","displayName":"CATV-MAC 19","$$hashKey":"object:7019"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 20","$$hashKey":"object:7020"},{"value":"CATV-MAC 21","displayName":"CATV-MAC 21","$$hashKey":"object:7021"},{"value":"CATV-MAC 22","displayName":"CATV-MAC 22","$$hashKey":"object:7022"},{"value":"CATV-MAC 23","displayName":"CATV-MAC 23","$$hashKey":"object:7023"},{"value":"CATV-MAC 24","displayName":"CATV-MAC 24","$$hashKey":"object:7024"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 25","$$hashKey":"object:7025"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 26","$$hashKey":"object:7026"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 27","$$hashKey":"object:7027"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 28","$$hashKey":"object:7028"},{"value":"CATV-MAC 20","displayName":"CATV-MAC 29","$$hashKey":"object:7029"}],"hidden":false,"$$hashKey":"object:6971"}}},"apps":[],"jobName":"paragraph_1538412831035_-1958208318","id":"20181001-165351_1057124686","dateCreated":"2018-10-01T16:53:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1761","dateFinished":"2018-10-01T17:16:02+0000","dateStarted":"2018-10-01T17:15:35+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.unix_timestamp\nCBU: Object = SWO\nPHUB: Object = PG07\nCMTS: Object = cmts77.ktgc\nCATV: Object = CATV-MAC 1\nactual_path: String = s3://video-poc-test-case/ARIMA/up_trending/output/SWO/PG07/cmts77.ktgc/CATV-MAC 1/_actual/\ncapacity: String = s3://video-poc-test-case/ARIMA/up_trending/output/SWO/PG07/cmts77.ktgc/CATV-MAC 1/_capacity/\npredicted: String = s3://video-poc-test-case/ARIMA/up_trending/output/SWO/PG07/cmts77.ktgc/CATV-MAC 1/_predict/\nactual_data_df: org.apache.spark.sql.DataFrame = [value: string]\npredicted_df: org.apache.spark.sql.DataFrame = [value: string]\ncapacity_rdd: Array[String] = Array(2.335298827E9)\n2.335298827E9\nprediction after this date\nres153: org.apache.spark.sql.Row = [4/9/2018,3.160210759090911E8]\ndf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, capacity: string]\ndf_predicted: org.apache.spark.sql.DataFrame = [pred: string, date: string]\ndf_cap: org.apache.spark.sql.DataFrame = [date: string, capacity: string]\ndf_union: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, capacity: string]\n"},{"type":"TABLE","data":"date\tcapacity\n3/2/2018\t8.5632902E7\n3/3/2018\t9.169574868181819E7\n3/4/2018\t9.775859536363637E7\n3/5/2018\t1.0382144204545456E8\n3/6/2018\t1.0988428872727275E8\n3/7/2018\t1.1594713540909094E8\n3/8/2018\t1.2200998209090912E8\n3/9/2018\t1.2807282877272731E8\n3/10/2018\t1.341356754545455E8\n3/11/2018\t1.401985221363637E8\n3/12/2018\t1.4626136881818187E8\n3/13/2018\t1.5232421550000006E8\n3/14/2018\t1.5838706218181825E8\n3/15/2018\t1.6444990886363643E8\n3/16/2018\t1.7051275554545462E8\n3/17/2018\t1.765756022272728E8\n3/18/2018\t1.82638448909091E8\n3/19/2018\t1.8870129559090918E8\n3/20/2018\t1.9476414227272737E8\n3/21/2018\t2.0082698895454556E8\n3/22/2018\t2.0688983563636374E8\n3/23/2018\t2.1295268231818193E8\n3/24/2018\t2.1901552900000012E8\n3/25/2018\t2.250783756818183E8\n3/26/2018\t2.311412223636365E8\n3/27/2018\t2.3720406904545468E8\n3/28/2018\t2.4326691572727287E8\n3/29/2018\t2.4932976240909106E8\n3/30/2018\t2.5539260909090924E8\n3/31/2018\t2.6145545577272743E8\n4/1/2018\t2.6751830245454562E8\n4/2/2018\t2.735811491363638E8\n4/3/2018\t2.79643995818182E8\n4/4/2018\t2.857068425000002E8\n4/5/2018\t2.9176968918181837E8\n4/6/2018\t2.9783253586363655E8\n4/7/2018\t3.0389538254545474E8\n4/8/2018\t3.099582292272729E8\n4/9/2018\t3.160210759090911E8\n4/10/2018\t2.66765254E8\n3/6/2018\t1.4915965411506563E8\n3/11/2018\t1.618322368273862E8\n3/5/2018\t1.5392542824653015E8\n3/16/2018\t1.5404775270473593E8\n3/21/2018\t1.5759753674574202E8\n3/2/2018\t1.5122781287505457E8\n3/10/2018\t1.5401153078054535E8\n3/7/2018\t1.5240020887103057E8\n3/12/2018\t1.6072400261326957E8\n3/15/2018\t1.4815621636567128E8\n3/17/2018\t1.551889955197401E8\n3/4/2018\t1.4893000288251722E8\n3/20/2018\t1.555693906407059E8\n3/9/2018\t1.5058493586872756E8\n3/14/2018\t1.5973285926293808E8\n3/19/2018\t1.6477943883131886E8\n3/3/2018\t1.4566497817056715E8\n3/8/2018\t1.597760405011818E8\n3/13/2018\t1.6451659571513408E8\n3/18/2018\t1.5699523258379546E8\n"}]}},{"text":"%spark\n","user":"anonymous","dateUpdated":"2018-10-01T16:58:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538413125118_-297605230","id":"20181001-165845_957633171","dateCreated":"2018-10-01T16:58:45+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3283"}],"name":"CAPACITY PREDICTION","id":"2DRJ2JVGW","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}